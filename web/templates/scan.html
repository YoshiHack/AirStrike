{% extends 'base.html' %}

{% block title %}AirStrike - Scan Networks{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">Scan WiFi Networks</div>
    <div class="card-body">
        <div class="scan-controls">
            <button id="scan-networks-btn" class="btn btn-primary">Scan Networks</button>
        </div>
        
        <div class="card mt-4">
            <div class="card-header">Available Networks</div>
            <div class="card-body">
                <div id="network-list" class="network-list">
                    <div class="network-item">Click "Scan Networks" to begin...</div>
                </div>
            </div>
        </div>
        
        <div class="mt-4 text-center">
            <a id="continue-btn" href="{{ url_for('attacks.show_attack') }}" class="btn btn-success" disabled>Continue to Attack Configuration</a>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Disable continue button by default
    document.addEventListener('DOMContentLoaded', function() {
        const continueBtn = document.getElementById('continue-btn');
        if (continueBtn) {
            continueBtn.disabled = true;
        }
        
        // Check if a network was previously selected
        const storedNetwork = sessionStorage.getItem('selectedNetwork');
        if (storedNetwork) {
            const networkData = JSON.parse(storedNetwork);
            const networkList = document.getElementById('network-list');
            
            // Show a message about the previously selected network
            networkList.innerHTML = `
                <div class="alert alert-info">
                    Previously selected network: ${networkData.essid || 'Hidden Network'} (${networkData.bssid})
                    <br>
                    Click "Scan Networks" to select a different network.
                </div>
            `;
            
            // Enable the continue button
            if (continueBtn) {
                continueBtn.disabled = false;
            }
        }
    });
</script>
{% endblock %}